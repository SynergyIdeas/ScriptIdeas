    <script>
        (function() {
            "use strict";
            
            // Data storage
            var data = {
                networkDrives: [],
                applications: [],
                fileCopies: [],
                registryEntries: [],
                registryFiles: [],
                fonts: [],
                fontDirectories: [],
                certificates: [],
                startupApps: []
            };

            // Tab switching functionality
            function switchToTab(tabId) {
                console.log('Switching to tab:', tabId);
                
                // Remove active class from all nav items
                var navItems = document.querySelectorAll('.nav-item');
                for (var i = 0; i < navItems.length; i++) {
                    navItems[i].classList.remove('active');
                }
                
                // Remove active class from all tab contents
                var tabContents = document.querySelectorAll('.tab-content');
                for (var i = 0; i < tabContents.length; i++) {
                    tabContents[i].classList.remove('active');
                }
                
                // Add active class to selected nav item
                var navItem = document.querySelector('[data-tab="' + tabId + '"]');
                if (navItem) {
                    navItem.classList.add('active');
                    console.log('Nav item activated:', tabId);
                } else {
                    console.error('Nav item not found for:', tabId);
                }
                
                // Add active class to selected tab content
                var tabContent = document.getElementById(tabId);
                if (tabContent) {
                    tabContent.classList.add('active');
                    console.log('Tab content activated:', tabId);
                } else {
                    console.error('Tab content not found for:', tabId);
                }
            }

            // Dashboard count updates
            function updateDashboardCounts() {
                var elements = [
                    { id: 'network-drives-count', count: data.networkDrives.length },
                    { id: 'applications-count', count: data.applications.length },
                    { id: 'file-copies-count', count: data.fileCopies.length },
                    { id: 'registry-entries-count', count: data.registryEntries.length },
                    { id: 'fonts-count', count: data.fonts.length },
                    { id: 'certificates-count', count: data.certificates.length },
                    { id: 'startup-scripts-count', count: data.startupApps.length }
                ];

                for (var i = 0; i < elements.length; i++) {
                    var element = elements[i];
                    var countElement = document.getElementById(element.id);
                    if (countElement) {
                        countElement.textContent = element.count;
                    }
                }
            }

            // Network Drive Functions
            function addNetworkDrive() {
                console.log('Adding network drive...');
                var driveLetterEl = document.getElementById('drive-letter');
                var networkPathEl = document.getElementById('network-path');
                
                if (!driveLetterEl || !networkPathEl) {
                    console.error('Drive letter or network path elements not found');
                    return;
                }
                
                var driveLetter = driveLetterEl.value;
                var networkPath = networkPathEl.value.trim();

                if (!networkPath) {
                    alert('Please enter a network path');
                    return;
                }

                var networkDrive = {
                    id: Date.now(),
                    driveLetter: driveLetter,
                    networkPath: networkPath
                };

                data.networkDrives.push(networkDrive);
                updateNetworkDrivesList();
                updateDashboardCounts();
                
                networkPathEl.value = '';
                console.log('Network drive added successfully');
            }

            function updateNetworkDrivesList() {
                var list = document.getElementById('network-drives-list');
                if (!list) {
                    console.error('Network drives list element not found');
                    return;
                }

                list.innerHTML = '';

                if (data.networkDrives.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No network drives configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.networkDrives.length; i++) {
                    var drive = data.networkDrives[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-drive="' + drive.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + drive.driveLetter + '</strong> ‚Üí ' + drive.networkPath;
                    list.appendChild(item);
                }
            }

            function removeNetworkDrive(id) {
                console.log('Removing network drive:', id);
                data.networkDrives = data.networkDrives.filter(function(drive) {
                    return drive.id !== id;
                });
                updateNetworkDrivesList();
                updateDashboardCounts();
            }

            // Application Functions
            function addApplication() {
                console.log('Adding application...');
                var appNameEl = document.getElementById('app-name');
                var installerPathEl = document.getElementById('installer-path');
                var installArgsEl = document.getElementById('install-args');
                var waitForCompletionEl = document.getElementById('wait-for-completion');
                
                if (!appNameEl || !installerPathEl || !installArgsEl || !waitForCompletionEl) {
                    console.error('Application form elements not found');
                    return;
                }

                var appName = appNameEl.value.trim();
                var installerPath = installerPathEl.value.trim();
                var installArgs = installArgsEl.value.trim();
                var waitForCompletion = waitForCompletionEl.checked;

                if (!appName || !installerPath) {
                    alert('Please enter application name and installer path');
                    return;
                }

                var application = {
                    id: Date.now(),
                    appName: appName,
                    installerPath: installerPath,
                    installArgs: installArgs,
                    waitForCompletion: waitForCompletion
                };

                data.applications.push(application);
                updateApplicationsList();
                updateDashboardCounts();
                
                // Clear form
                appNameEl.value = '';
                installerPathEl.value = '';
                installArgsEl.value = '';
                waitForCompletionEl.checked = false;
                
                console.log('Application added successfully');
            }

            function updateApplicationsList() {
                var list = document.getElementById('applications-list');
                if (!list) {
                    console.error('Applications list element not found');
                    return;
                }

                list.innerHTML = '';

                if (data.applications.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No applications configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.applications.length; i++) {
                    var app = data.applications[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-app="' + app.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + app.appName + '</strong><br>' +
                        'Path: ' + app.installerPath + '<br>' +
                        'Args: ' + (app.installArgs || 'None') + '<br>' +
                        '<small>Wait for completion: ' + (app.waitForCompletion ? 'Yes' : 'No') + '</small>';
                    list.appendChild(item);
                }
            }

            function removeApplication(id) {
                console.log('Removing application:', id);
                data.applications = data.applications.filter(function(app) {
                    return app.id !== id;
                });
                updateApplicationsList();
                updateDashboardCounts();
            }

            // File Copy Functions
            function addFileCopy() {
                console.log('Adding file copy...');
                var sourcePathEl = document.getElementById('source-path');
                var destinationPathEl = document.getElementById('destination-path');
                var copyFolderEl = document.getElementById('copy-folder');
                var overwriteExistingEl = document.getElementById('overwrite-existing');
                var validateCopyEl = document.getElementById('validate-copy');
                
                if (!sourcePathEl || !destinationPathEl || !copyFolderEl || !overwriteExistingEl || !validateCopyEl) {
                    console.error('File copy form elements not found');
                    return;
                }

                var sourcePath = sourcePathEl.value.trim();
                var destinationPath = destinationPathEl.value.trim();
                var copyFolder = copyFolderEl.checked;
                var overwriteExisting = overwriteExistingEl.checked;
                var validateCopy = validateCopyEl.checked;

                if (!sourcePath || !destinationPath) {
                    alert('Please enter source and destination paths');
                    return;
                }

                var fileCopy = {
                    id: Date.now(),
                    sourcePath: sourcePath,
                    destinationPath: destinationPath,
                    copyFolder: copyFolder,
                    overwriteExisting: overwriteExisting,
                    validateCopy: validateCopy
                };

                data.fileCopies.push(fileCopy);
                updateFileCopiesList();
                updateDashboardCounts();
                
                // Clear form
                sourcePathEl.value = '';
                destinationPathEl.value = '';
                copyFolderEl.checked = false;
                overwriteExistingEl.checked = false;
                validateCopyEl.checked = true;
                
                console.log('File copy added successfully');
            }

            function updateFileCopiesList() {
                var list = document.getElementById('file-copy-list');
                if (!list) {
                    console.error('File copy list element not found');
                    return;
                }

                list.innerHTML = '';

                if (data.fileCopies.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No file operations configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.fileCopies.length; i++) {
                    var file = data.fileCopies[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-file="' + file.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + file.sourcePath + '</strong> ‚Üí ' + file.destinationPath + '<br>' +
                        '<small>Folder copy: ' + (file.copyFolder ? 'Yes' : 'No') + ' | Overwrite: ' + (file.overwriteExisting ? 'Yes' : 'No') + ' | Validate: ' + (file.validateCopy ? 'Yes' : 'No') + '</small>';
                    list.appendChild(item);
                }
            }

            function removeFileCopy(id) {
                console.log('Removing file copy:', id);
                data.fileCopies = data.fileCopies.filter(function(file) {
                    return file.id !== id;
                });
                updateFileCopiesList();
                updateDashboardCounts();
            }

            // Registry Functions
            function addRegistryFile() {
                console.log('Adding registry file...');
                var regFilePathEl = document.getElementById('reg-file-path');
                var regFileSilentEl = document.getElementById('reg-file-silent');
                
                if (!regFilePathEl || !regFileSilentEl) {
                    console.error('Registry file form elements not found');
                    return;
                }

                var regFilePath = regFilePathEl.value.trim();
                var regFileSilent = regFileSilentEl.checked;

                if (!regFilePath) {
                    alert('Please enter a registry file path');
                    return;
                }

                var registryFile = {
                    id: Date.now(),
                    regFilePath: regFilePath,
                    regFileSilent: regFileSilent,
                    type: 'file'
                };

                data.registryFiles.push(registryFile);
                updateRegistryList();
                updateDashboardCounts();
                
                // Clear form
                regFilePathEl.value = '';
                regFileSilentEl.checked = true;
                
                console.log('Registry file added successfully');
            }

            function addRegistryEntry() {
                console.log('Adding registry entry...');
                var regHiveEl = document.getElementById('reg-hive');
                var regPathEl = document.getElementById('reg-path');
                var regNameEl = document.getElementById('reg-name');
                var regTypeEl = document.getElementById('reg-type');
                var regValueEl = document.getElementById('reg-value');
                
                if (!regHiveEl || !regPathEl || !regNameEl || !regTypeEl || !regValueEl) {
                    console.error('Registry form elements not found');
                    return;
                }

                var regHive = regHiveEl.value;
                var regPath = regPathEl.value.trim();
                var regName = regNameEl.value.trim();
                var regType = regTypeEl.value;
                var regValue = regValueEl.value.trim();

                if (!regPath || !regName || !regValue) {
                    alert('Please fill in all registry fields');
                    return;
                }

                var registryEntry = {
                    id: Date.now(),
                    regHive: regHive,
                    regPath: regPath,
                    regName: regName,
                    regType: regType,
                    regValue: regValue,
                    type: 'entry'
                };

                data.registryEntries.push(registryEntry);
                updateRegistryList();
                updateDashboardCounts();
                
                // Clear form
                regPathEl.value = '';
                regNameEl.value = '';
                regValueEl.value = '';
                
                console.log('Registry entry added successfully');
            }

            function updateRegistryList() {
                var list = document.getElementById('registry-list');
                if (!list) {
                    console.error('Registry list element not found');
                    return;
                }

                list.innerHTML = '';
                
                var allItems = data.registryFiles.concat(data.registryEntries);
                
                if (allItems.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No registry operations configured yet.</p>';
                    return;
                }

                for (var i = 0; i < allItems.length; i++) {
                    var item = allItems[i];
                    var itemDiv = document.createElement('div');
                    itemDiv.className = 'item';
                    
                    if (item.type === 'file') {
                        itemDiv.innerHTML = 
                            '<div class="item-actions">' +
                                '<button type="button" class="remove-btn" data-remove-reg-file="' + item.id + '" title="Delete">üóëÔ∏è</button>' +
                            '</div>' +
                            '<strong>üìÑ Registry File:</strong> ' + item.regFilePath + '<br>' +
                            '<small>Silent import: ' + (item.regFileSilent ? 'Yes' : 'No') + '</small>';
                    } else {
                        itemDiv.innerHTML = 
                            '<div class="item-actions">' +
                                '<button type="button" class="remove-btn" data-remove-registry="' + item.id + '" title="Delete">üóëÔ∏è</button>' +
                            '</div>' +
                            '<strong>üîß Registry Entry:</strong> ' + item.regHive + '\\' + item.regPath + '<br>' +
                            'Name: ' + item.regName + ' | Type: ' + item.regType + ' | Value: ' + item.regValue;
                    }
                    list.appendChild(itemDiv);
                }
            }

            function removeRegistryFile(id) {
                console.log('Removing registry file:', id);
                data.registryFiles = data.registryFiles.filter(function(file) {
                    return file.id !== id;
                });
                updateRegistryList();
                updateDashboardCounts();
            }

            function removeRegistryEntry(id) {
                console.log('Removing registry entry:', id);
                data.registryEntries = data.registryEntries.filter(function(reg) {
                    return reg.id !== id;
                });
                updateRegistryList();
                updateDashboardCounts();
            }

            // Font Functions
            function addFont() {
                console.log('Adding font...');
                var fontPathEl = document.getElementById('font-path');
                var fontNameEl = document.getElementById('font-name');
                
                if (!fontPathEl || !fontNameEl) {
                    console.error('Font form elements not found');
                    return;
                }

                var fontPath = fontPathEl.value.trim();
                var fontName = fontNameEl.value.trim();

                if (!fontPath) {
                    alert('Please enter a font file path');
                    return;
                }

                var font = {
                    id: Date.now(),
                    fontPath: fontPath,
                    fontName: fontName,
                    type: 'single'
                };

                data.fonts.push(font);
                updateFontsList();
                updateDashboardCounts();
                
                // Clear form
                fontPathEl.value = '';
                fontNameEl.value = '';
                
                console.log('Font added successfully');
            }

            function addFontDirectory() {
                console.log('Adding font directory...');
                var fontDirectoryEl = document.getElementById('font-directory');
                var fontExtensionsEl = document.getElementById('font-extensions');
                var fontRecursiveEl = document.getElementById('font-recursive');
                var fontSkipExistingEl = document.getElementById('font-skip-existing');
                
                if (!fontDirectoryEl || !fontExtensionsEl || !fontRecursiveEl || !fontSkipExistingEl) {
                    console.error('Font directory form elements not found');
                    return;
                }

                var fontDirectory = fontDirectoryEl.value.trim();
                var fontExtensions = fontExtensionsEl.value.trim();
                var fontRecursive = fontRecursiveEl.checked;
                var skipExisting = fontSkipExistingEl.checked;

                if (!fontDirectory) {
                    alert('Please enter a font directory path');
                    return;
                }

                var fontDir = {
                    id: Date.now(),
                    fontDirectory: fontDirectory,
                    fontExtensions: fontExtensions,
                    fontRecursive: fontRecursive,
                    skipExisting: skipExisting,
                    type: 'directory'
                };

                data.fontDirectories.push(fontDir);
                updateFontsList();
                updateDashboardCounts();
                
                // Clear form
                fontDirectoryEl.value = '';
                fontExtensionsEl.value = '*.ttf,*.otf,*.woff,*.woff2';
                fontRecursiveEl.checked = true;
                fontSkipExistingEl.checked = true;
                
                console.log('Font directory added successfully');
            }

            function updateFontsList() {
                var list = document.getElementById('fonts-list');
                if (!list) {
                    console.error('Fonts list element not found');
                    return;
                }

                list.innerHTML = '';
                
                var allFonts = data.fonts.concat(data.fontDirectories);
                
                if (allFonts.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No fonts configured yet.</p>';
                    return;
                }

                for (var i = 0; i < allFonts.length; i++) {
                    var font = allFonts[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    
                    if (font.type === 'single') {
                        item.innerHTML = 
                            '<div class="item-actions">' +
                                '<button type="button" class="remove-btn" data-remove-font="' + font.id + '" title="Delete">üóëÔ∏è</button>' +
                            '</div>' +
                            '<strong>üìÑ Single Font:</strong> ' + font.fontPath +
                            (font.fontName ? '<br>Name: ' + font.fontName : '');
                    } else {
                        item.innerHTML = 
                            '<div class="item-actions">' +
                                '<button type="button" class="remove-btn" data-remove-font-dir="' + font.id + '" title="Delete">üóëÔ∏è</button>' +
                            '</div>' +
                            '<strong>üìÅ Font Directory:</strong> ' + font.fontDirectory + '<br>' +
                            'Extensions: ' + font.fontExtensions + '<br>' +
                            '<small>Recursive: ' + (font.fontRecursive ? 'Yes' : 'No') + ' | Skip existing: ' + (font.skipExisting ? 'Yes' : 'No') + '</small>';
                    }
                    list.appendChild(item);
                }
            }

            function removeFont(id) {
                console.log('Removing font:', id);
                data.fonts = data.fonts.filter(function(font) {
                    return font.id !== id;
                });
                updateFontsList();
                updateDashboardCounts();
            }

            function removeFontDirectory(id) {
                console.log('Removing font directory:', id);
                data.fontDirectories = data.fontDirectories.filter(function(dir) {
                    return dir.id !== id;
                });
                updateFontsList();
                updateDashboardCounts();
            }

            // Certificate Functions
            function addCertificate() {
                console.log('Adding certificate...');
                var certPathEl = document.getElementById('cert-path');
                var certStoreEl = document.getElementById('cert-store');
                var certLocationEl = document.getElementById('cert-location');
                
                if (!certPathEl || !certStoreEl || !certLocationEl) {
                    console.error('Certificate form elements not found');
                    return;
                }

                var certPath = certPathEl.value.trim();
                var certStore = certStoreEl.value;
                var certLocation = certLocationEl.value;

                if (!certPath) {
                    alert('Please enter a certificate file path');
                    return;
                }

                var certificate = {
                    id: Date.now(),
                    certPath: certPath,
                    certStore: certStore,
                    certLocation: certLocation
                };

                data.certificates.push(certificate);
                updateCertificatesList();
                updateDashboardCounts();
                
                // Clear form
                certPathEl.value = '';
                
                console.log('Certificate added successfully');
            }

            function updateCertificatesList() {
                var list = document.getElementById('certificates-list');
                if (!list) {
                    console.error('Certificates list element not found');
                    return;
                }

                list.innerHTML = '';

                if (data.certificates.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No certificates configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.certificates.length; i++) {
                    var cert = data.certificates[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-cert="' + cert.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + cert.certPath + '</strong><br>' +
                        'Store: ' + cert.certStore + ' (' + cert.certLocation + ')';
                    list.appendChild(item);
                }
            }

            function removeCertificate(id) {
                console.log('Removing certificate:', id);
                data.certificates = data.certificates.filter(function(cert) {
                    return cert.id !== id;
                });
                updateCertificatesList();
                updateDashboardCounts();
            }

            // Startup App Functions
            function addStartupApp() {
                console.log('Adding startup app...');
                var appNameEl = document.getElementById('startup-app-name');
                var appPathEl = document.getElementById('startup-app-path');
                var appArgsEl = document.getElementById('startup-app-args');
                var delayEl = document.getElementById('startup-delay');
                var waitForExitEl = document.getElementById('startup-wait-exit');
                
                if (!appNameEl || !appPathEl || !appArgsEl || !delayEl || !waitForExitEl) {
                    console.error('Startup app form elements not found');
                    return;
                }

                var appName = appNameEl.value.trim();
                var appPath = appPathEl.value.trim();
                var appArgs = appArgsEl.value.trim();
                var delay = parseInt(delayEl.value, 10) || 0;
                var waitForExit = waitForExitEl.checked;

                if (!appName || !appPath) {
                    alert('Please enter application name and path');
                    return;
                }

                var startupApp = {
                    id: Date.now(),
                    appName: appName,
                    appPath: appPath,
                    appArgs: appArgs,
                    delay: delay,
                    waitForExit: waitForExit
                };

                data.startupApps.push(startupApp);
                updateStartupAppsList();
                updateDashboardCounts();
                
                // Clear form
                appNameEl.value = '';
                appPathEl.value = '';
                appArgsEl.value = '';
                delayEl.value = '0';
                waitForExitEl.checked = false;
                
                console.log('Startup app added successfully');
            }

            function updateStartupAppsList() {
                var list = document.getElementById('startup-apps-list');
                if (!list) {
                    console.error('Startup apps list element not found');
                    return;
                }

                list.innerHTML = '';

                if (data.startupApps.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No startup applications configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.startupApps.length; i++) {
                    var app = data.startupApps[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-startup="' + app.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + (i + 1) + '. ' + app.appName + '</strong><br>' +
                        'Path: ' + app.appPath + '<br>' +
                        'Args: ' + (app.appArgs || 'None') + ' | Delay: ' + app.delay + 's<br>' +
                        '<small>Wait for exit: ' + (app.waitForExit ? 'Yes' : 'No') + '</small>';
                    list.appendChild(item);
                }
            }

            function removeStartupApp(id) {
                console.log('Removing startup app:', id);
                data.startupApps = data.startupApps.filter(function(app) {
                    return app.id !== id;
                });
                updateStartupAppsList();
                updateDashboardCounts();
            }

            // Script Generation Functions
            function generateScript() {
                console.log('Generating script...');
                var addLoggingEl = document.getElementById('add-logging');
                var addErrorHandlingEl = document.getElementById('add-error-handling');
                var requireAdminEl = document.getElementById('require-admin');
                var autoRebootEl = document.getElementById('auto-reboot');
                var rebootDelayEl = document.getElementById('reboot-delay');
                
                if (!addLoggingEl || !addErrorHandlingEl) {
                    console.error('Script generation form elements not found');
                    return;
                }

                var addLogging = addLoggingEl.checked;
                var addErrorHandling = addErrorHandlingEl.checked;
                var requireAdmin = requireAdminEl ? requireAdminEl.checked : false;
                var autoReboot = autoRebootEl ? autoRebootEl.checked : false;
                var rebootDelay = rebootDelayEl ? (parseInt(rebootDelayEl.value, 10) || 10) : 10;

                var script = '';

                script += '# PowerShell Deployment Script\n';
                script += '# Generated by PowerShell Script Generator\n';
                script += '# Generated on: ' + new Date().toLocaleDateString('en-GB') + '\n\n';

                if (requireAdmin) {
                    script += '# Check for Administrator privileges\n';
                    script += 'if (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {\n';
                    script += '    Write-Host "This script requires Administrator privileges. Please run as Administrator." -ForegroundColor Red\n';
                    script += '    exit 1\n';
                    script += '}\n\n';
                }

                if (addLogging) {
                    script += '# Setup logging\n';
                    script += '$LogPath = "$env:TEMP\\deployment_log_$(Get-Date -Format "dd-MM-yyyy_HHmmss").txt"\n';
                    script += 'function Write-Log {\n';
                    script += '    param([string]$Message, [string]$Level = "INFO")\n';
                    script += '    $TimeStamp = Get-Date -Format "dd-MM-yyyy HH:mm:ss"\n';
                    script += '    $LogEntry = "[$TimeStamp] [$Level] $Message"\n';
                    script += '    Write-Host $LogEntry\n';
                    script += '    Add-Content -Path $LogPath -Value $LogEntry\n';
                    script += '}\n\n';
                    script += 'Write-Log "Starting deployment script execution"\n\n';
                }

                if (addErrorHandling) {
                    script += '# Error handling\n';
                    script += '$ErrorActionPreference = "Stop"\n\n';
                }

                // Add network drives section
                if (data.networkDrives.length > 0) {
                    script += '# === NETWORK DRIVES ===\n';
                    if (addLogging) script += 'Write-Log "Configuring network drives"\n';
                    
                    for (var i = 0; i < data.networkDrives.length; i++) {
                        var drive = data.networkDrives[i];
                        if (addErrorHandling) {
                            script += 'try {\n    ';
                        }
                        script += 'New-PSDrive -Name "' + drive.driveLetter.replace(':', '') + '" -PSProvider FileSystem -Root "' + drive.networkPath + '" -Persist\n';
                        
                        if (addLogging) {
                            script += '    Write-Log "Mapped network drive ' + drive.driveLetter + ' to ' + drive.networkPath + '"\n';
                        }
                        
                        if (addErrorHandling) {
                            script += '} catch {\n';
                            if (addLogging) {
                                script += '    Write-Log "Failed to map drive ' + drive.driveLetter + ': $($_.Exception.Message)" "ERROR"\n';
                            }
                            script += '}\n';
                        }
                        script += '\n';
                    }
                }

                // Add other sections similarly...
                script += '\nWrite-Host "Deployment script completed!" -ForegroundColor Green\n';

                var scriptElement = document.getElementById('generated-script');
                if (scriptElement) {
                    scriptElement.textContent = script;
                    console.log('Script generated successfully');
                } else {
                    console.error('Generated script element not found');
                }
            }

            function generateStartupScript() {
                console.log('Generating startup script...');
                var script = '';

                script += '# StartupScript.ps1 - Application Startup Script\n';
                script += '# Generated by PowerShell Script Generator\n';
                script += '# Generated on: ' + new Date().toLocaleDateString('en-GB') + '\n\n';

                if (data.startupApps.length > 0) {
                    script += '# === APPLICATION STARTUP SEQUENCE ===\n';
                    
                    for (var i = 0; i < data.startupApps.length; i++) {
                        var app = data.startupApps[i];
                        script += '\n# Launch ' + app.appName + ' (Step ' + (i + 1) + ')\n';

                        if (app.delay > 0) {
                            script += 'Write-Host "‚è≥ Waiting ' + app.delay + ' seconds..." -ForegroundColor Cyan\n';
                            script += 'Start-Sleep -Seconds ' + app.delay + '\n';
                        }

                        script += 'Start-Process -FilePath "' + app.appPath + '"';
                        if (app.appArgs) {
                            script += ' -ArgumentList "' + app.appArgs + '"';
                        }
                        if (app.waitForExit) {
                            script += ' -Wait';
                        }
                        script += '\n';
                        script += 'Write-Host "‚úì Launched ' + app.appName + '" -ForegroundColor Green\n\n';
                    }
                }

                script += 'Write-Host "üöÄ Startup sequence completed!" -ForegroundColor Green\n';

                var scriptElement = document.getElementById('generated-startup-script');
                if (scriptElement) {
                    scriptElement.textContent = script;
                    console.log('Startup script generated successfully');
                } else {
                    console.error('Generated startup script element not found');
                }
            }

            function copyScriptToClipboard() {
                console.log('Copying script to clipboard...');
                var scriptElement = document.getElementById('generated-script');
                if (!scriptElement) {
                    console.error('Generated script element not found');
                    return;
                }
                
                var scriptContent = scriptElement.textContent;
                
                if (scriptContent === 'No script generated yet. Configure components and click "Generate PowerShell Script".') {
                    alert('Please generate a script first');
                    return;
                }
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(scriptContent).then(function() {
                        alert('Script copied to clipboard!');
                        console.log('Script copied successfully');
                    }).catch(function(err) {
                        console.error('Failed to copy script:', err);
                        alert('Failed to copy script to clipboard');
                    });
                } else {
                    console.error('Clipboard API not supported');
                    alert('Clipboard API not supported in this browser');
                }
            }

            function copyStartupScriptToClipboard() {
                console.log('Copying startup script to clipboard...');
                var scriptElement = document.getElementById('generated-startup-script');
                if (!scriptElement) {
                    console.error('Generated startup script element not found');
                    return;
                }
                
                var scriptContent = scriptElement.textContent;
                
                if (scriptContent === 'No startup script generated yet. Configure applications and click "Generate Startup Script".') {
                    alert('Please generate a startup script first');
                    return;
                }
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(scriptContent).then(function() {
                        alert('Startup script copied to clipboard!');
                        console.log('Startup script copied successfully');
                    }).catch(function(err) {
                        console.error('Failed to copy startup script:', err);
                        alert('Failed to copy startup script to clipboard');
                    });
                } else {
                    console.error('Clipboard API not supported');
                    alert('Clipboard API not supported in this browser');
                }
            }

            // Browse functionality for file and folder selection
            function browseForFile(inputId) {
                console.log('Browse for file clicked:', inputId);
                var input = document.getElementById(inputId);
                if (!input) {
                    console.error('Input element not found:', inputId);
                    return;
                }
                
                // Create file input element
                var fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.style.display = 'none';
                
                // Handle file selection
                fileInput.onchange = function(e) {
                    if (e.target.files.length > 0) {
                        var file = e.target.files[0];
                        // In a real application, you would get the full path
                        // For demo purposes, we'll use a simulated path
                        input.value = 'C:\\Temp\\' + file.name;
                        console.log('File selected:', file.name);
                    }
                    document.body.removeChild(fileInput);
                };
                
                // Add to DOM and trigger click
                document.body.appendChild(fileInput);
                fileInput.click();
            }

            function browseForFolder(inputId) {
                console.log('Browse for folder clicked:', inputId);
                var input = document.getElementById(inputId);
                if (!input) {
                    console.error('Input element not found:', inputId);
                    return;
                }
                
                // For folder browsing, we'll use a simple prompt as web browsers
                // don't have native folder selection without special APIs
                var currentValue = input.value;
                var selectedFolder = prompt('Enter folder path for ' + inputId.replace('-', ' ') + ':', currentValue || 'C:\\Temp\\');
                if (selectedFolder && selectedFolder.trim()) {
                    input.value = selectedFolder.trim();
                    console.log('Folder selected:', selectedFolder.trim());
                }
            }
            function initializeEventListeners() {
                console.log('Initializing event listeners...');

                // Navigation event listeners
                var navItems = document.querySelectorAll('.nav-item');
                console.log('Found', navItems.length, 'nav items');
                
                for (var i = 0; i < navItems.length; i++) {
                    (function(item) {
                        item.addEventListener('click', function(e) {
                            e.preventDefault();
                            var tabId = this.getAttribute('data-tab');
                            console.log('Nav item clicked:', tabId);
                            if (tabId) {
                                switchToTab(tabId);
                            }
                        });
                    })(navItems[i]);
                }

                // Dashboard card click handlers
                var dashboardCards = document.querySelectorAll('.dashboard-card');
                console.log('Found', dashboardCards.length, 'dashboard cards');
                
                for (var i = 0; i < dashboardCards.length; i++) {
                    (function(card) {
                        card.addEventListener('click', function(e) {
                            e.preventDefault();
                            var tabId = this.getAttribute('data-tab-click');
                            console.log('Dashboard card clicked:', tabId);
                            if (tabId) {
                                switchToTab(tabId);
                            }
                        });
                    })(dashboardCards[i]);
                }

                // Button event listeners with detailed logging
                var buttonConfigs = [
                    { id: 'add-network-drive', handler: addNetworkDrive, name: 'Add Network Drive' },
                    { id: 'add-application', handler: addApplication, name: 'Add Application' },
                    { id: 'add-file-copy', handler: addFileCopy, name: 'Add File Copy' },
                    { id: 'add-registry', handler: addRegistryEntry, name: 'Add Registry' },
                    { id: 'add-font', handler: addFont, name: 'Add Font' },
                    { id: 'add-certificate', handler: addCertificate, name: 'Add Certificate' },
                    { id: 'add-startup-app', handler: addStartupApp, name: 'Add Startup App' },
                    { id: 'generate-script', handler: generateScript, name: 'Generate Script' },
                    { id: 'copy-script', handler: copyScriptToClipboard, name: 'Copy Script' },
                    { id: 'generate-startup-script', handler: generateStartupScript, name: 'Generate Startup Script' },
                    { id: 'copy-startup-script', handler: copyStartupScriptToClipboard, name: 'Copy Startup Script' },
                    { id: 'home-generate-btn', handler: function() { switchToTab('generate'); }, name: 'Home Generate Button' }
                ];

                for (var i = 0; i < buttonConfigs.length; i++) {
                    var config = buttonConfigs[i];
                    var element = document.getElementById(config.id);
                    if (element) {
                        console.log('Adding event listener for:', config.name);
                        (function(cfg) {
                            element.addEventListener('click', function(e) {
                                e.preventDefault();
                                console.log('Button clicked:', cfg.name);
                                try {
                                    cfg.handler();
                                } catch (error) {
                                    console.error('Error in button handler for', cfg.name, ':', error);
                                }
                            });
                        })(config);
                    } else {
                        console.warn('Button not found:', config.id);
                    }
                }

                // Auto reboot toggle functionality
                var autoRebootCheckbox = document.getElementById('auto-reboot');
                if (autoRebootCheckbox) {
                    console.log('Adding auto reboot toggle listener');
                    autoRebootCheckbox.addEventListener('change', function() {
                        var rebootDelayGroup = document.getElementById('reboot-delay-group');
                        if (rebootDelayGroup) {
                            if (this.checked) {
                                rebootDelayGroup.style.display = 'block';
                            } else {
                                rebootDelayGroup.style.display = 'none';
                            }
                        }
                    });
                } else {
                    console.log('Auto reboot checkbox not found (expected for some tabs)');
                }

                // Browse button event listeners
                var browseButtons = document.querySelectorAll('.btn-secondary');
                console.log('Found', browseButtons.length, 'browse buttons');
                
                for (var i = 0; i < browseButtons.length; i++) {
                    (function(button) {
                        button.addEventListener('click', function(e) {
                            e.preventDefault();
                            console.log('Browse button clicked');
                            
                            // Find the associated input field
                            var inputGroup = this.closest('.input-group');
                            if (inputGroup) {
                                var input = inputGroup.querySelector('input[type="text"]');
                                if (input) {
                                    var inputId = input.id;
                                    console.log('Associated input ID:', inputId);
                                    
                                    // Determine if it's for file or folder based on the input ID
                                    if (inputId.includes('directory') || inputId.includes('working-dir') || inputId.includes('destination-path')) {
                                        browseForFolder(inputId);
                                    } else {
                                        browseForFile(inputId);
                                    }
                                } else {
                                    console.error('No input found in input group');
                                }
                            } else {
                                console.error('No input group found for browse button');
                            }
                        });
                    })(browseButtons[i]);
                }

                // Event delegation for dynamically created remove buttons
                document.addEventListener('click', function(e) {
                    if (e.target && e.target.classList.contains('remove-btn')) {
                        e.preventDefault();
                        console.log('Remove button clicked');
                        
                        var driveId = e.target.getAttribute('data-remove-drive');
                        var appId = e.target.getAttribute('data-remove-app');
                        var fileId = e.target.getAttribute('data-remove-file');
                        var regId = e.target.getAttribute('data-remove-registry');
                        var fontId = e.target.getAttribute('data-remove-font');
                        var certId = e.target.getAttribute('data-remove-cert');
                        var startupId = e.target.getAttribute('data-remove-startup');

                        try {
                            if (driveId) {
                                removeNetworkDrive(parseInt(driveId, 10));
                            } else if (appId) {
                                removeApplication(parseInt(appId, 10));
                            } else if (fileId) {
                                removeFileCopy(parseInt(fileId, 10));
                            } else if (regId) {
                                removeRegistryEntry(parseInt(regId, 10));
                            } else if (fontId) {
                                removeFont(parseInt(fontId, 10));
                            } else if (certId) {
                                removeCertificate(parseInt(certId, 10));
                            } else if (startupId) {
                                removeStartupApp(parseInt(startupId, 10));
                            }
                        } catch (error) {
                            console.error('Error in remove handler:', error);
                        }
                    }
                });

                // Initialize dashboard counts
                updateDashboardCounts();
                
                console.log('PowerShell Generator initialized successfully');
            }

            // Initialize when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initializeEventListeners);
            } else {
                initializeEventListeners();
            }

        })();
    </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell Script Generator</title>
    <style>
        :root {
            --primary-color: #3C1053;
            --primary-light: #5c2383;
            --primary-dark: #2a0b3c;
            --text-light: #ffffff;
            --text-dark: #333333;
            --bg-light: #f5f5f5;
            --accent: #9e6dc2;
            --success: #28a745;
            --danger: #dc3545;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            height: 100vh;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            height: 100%;
            padding: 20px;
            box-sizing: border-box;
        }

        header {
            background-color: var(--primary-color);
            color: var(--text-light);
            padding: 8px 0;
            text-align: center;
            border-radius: 5px 5px 0 0;
        }

        h1 {
            font-size: 1.6rem;
        }

        .dashboard {
            display: flex;
            height: 100vh;
            margin-top: 0;
            overflow: hidden;
        }

        .sidebar {
            width: 250px;
            background-color: var(--primary-dark);
            border-radius: 0;
            overflow-y: auto;
            height: 100%;
        }

        .nav-item {
            padding: 15px 20px;
            color: var(--text-light);
            cursor: pointer;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }

        .nav-item:hover, .nav-item.active {
            background-color: var(--primary-light);
            border-left-color: var(--text-light);
        }

        .content {
            flex: 1;
            background-color: white;
            padding: 20px;
            border-radius: 0;
            box-shadow: none;
            overflow-y: auto;
            height: 100%;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        button {
            background-color: var(--primary-color);
            color: var(--text-light);
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: var(--primary-light);
        }

        .btn-secondary {
            background-color: var(--accent);
        }

        .card {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }

        .item-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .item {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            position: relative;
        }

        .item-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
        }

        .remove-btn {
            background-color: var(--danger);
            color: white;
            border: none;
            border-radius: 6px;
            width: 28px;
            height: 28px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 5px;
        }

        .remove-btn:hover {
            background-color: #c82333;
            transform: scale(1.1);
        }

        .edit-btn {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            width: 28px;
            height: 28px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .edit-btn:hover {
            background-color: #0056b3;
            transform: scale(1.1);
        }

        .generated-code {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            white-space: pre-wrap;
            overflow-x: auto;
            border: 1px solid #ddd;
            font-family: 'Courier New', Courier, monospace;
        }

        .toggle-wrapper {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
            margin-right: 10px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary-color);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .hidden {
            display: none;
        }

        .dashboard-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(60, 16, 83, 0.08);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(60, 16, 83, 0.1);
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(60, 16, 83, 0.12);
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: stretch;
        }

        .input-group input {
            flex: 1;
            margin: 0;
        }

        .input-group button {
            width: auto;
            padding: 10px 15px;
            white-space: nowrap;
        }

        .header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }

        .header-title {
            display: flex;
            align-items: center;
        }

        .header-logo {
            font-family: monospace;
            margin-right: 12px;
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 4px;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hero-section {
            text-align: center;
            padding: 40px 20px 30px;
            background: linear-gradient(135deg, #3C1053 0%, #5c2383 100%);
            border-radius: 16px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        .hero-bg {
            position: absolute;
            top: -100px;
            right: -100px;
            width: 300px;
            height: 300px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-logo {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.15);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            backdrop-filter: blur(10px);
        }

        .hero-title {
            color: white;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0 0 10px 0;
        }

        .hero-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 1.1rem;
            margin: 0;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .card-title {
            margin: 0;
            font-size: 18px;
            color: #2d3748;
            font-weight: 600;
        }

        .card-subtitle {
            margin: 4px 0 0 0;
            font-size: 14px;
            color: #718096;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            background: rgba(60, 16, 83, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-footer {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
        }

        .count-number {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .count-label {
            color: #718096;
            font-size: 14px;
            margin-left: 8px;
        }

        .card-link {
            color: var(--primary-color);
            font-size: 14px;
            font-weight: 500;
        }

        .cta-section {
            text-align: center;
            background: white;
            border-radius: 12px;
            padding: 32px;
            box-shadow: 0 4px 20px rgba(60, 16, 83, 0.08);
        }

        .cta-title {
            color: #2d3748;
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0 0 8px 0;
        }

        .cta-subtitle {
            color: #718096;
            margin: 0 0 24px 0;
        }

        .cta-button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
                height: auto;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                max-height: 50vh;
            }
            
            .content {
                height: auto;
                min-height: 60vh;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="dashboard">
            <div class="sidebar">
                <div class="nav-item active" data-tab="home">üè† Home</div>
                <div class="nav-item" data-tab="network-drives">üîå Network Drives</div>
                <div class="nav-item" data-tab="applications">üì¶ Applications</div>
                <div class="nav-item" data-tab="file-copy">üìÇ File Copy</div>
                <div class="nav-item" data-tab="registry">üîß Registry Entries</div>
                <div class="nav-item" data-tab="fonts">üî§ Fonts</div>
                <div class="nav-item" data-tab="certificates">üîí SSL Certificates</div>
                <div class="nav-item" data-tab="generate">‚ö° Generate Script</div>
                <div class="nav-item" data-tab="startup-scripts">üöÄ Startup Scripts</div>
            </div>
            
            <div class="content">
                <!-- Home Tab -->
                <div class="tab-content active" id="home">
                    <div class="hero-section">
                        <div class="hero-bg"></div>
                        <div class="hero-content">
                            <div class="hero-logo">
                                <span style="color: white; font-size: 24px; font-weight: bold;">PS</span>
                            </div>
                            <h1 class="hero-title">PowerShell Script Generator</h1>
                            <p class="hero-subtitle">Create deployment scripts with ease</p>
                        </div>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="dashboard-card" data-tab-click="network-drives">
                            <div class="card-header">
                                <div>
                                    <h3 class="card-title">Network Drives</h3>
                                    <p class="card-subtitle">Map network locations</p>
                                </div>
                                <div class="card-icon">
                                    <span style="font-size: 24px;">üîå</span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div>
                                    <span id="network-drives-count" class="count-number">0</span>
                                    <span class="count-label">configured</span>
                                </div>
                                <span class="card-link">Configure ‚Üí</span>
                            </div>
                        </div>
                        
                        <div class="dashboard-card" data-tab-click="applications">
                            <div class="card-header">
                                <div>
                                    <h3 class="card-title">Applications</h3>
                                    <p class="card-subtitle">Software installations</p>
                                </div>
                                <div class="card-icon">
                                    <span style="font-size: 24px;">üì¶</span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div>
                                    <span id="applications-count" class="count-number">0</span>
                                    <span class="count-label">configured</span>
                                </div>
                                <span class="card-link">Configure ‚Üí</span>
                            </div>
                        </div>
                        
                        <div class="dashboard-card" data-tab-click="file-copy">
                            <div class="card-header">
                                <div>
                                    <h3 class="card-title">File Operations</h3>
                                    <p class="card-subtitle">Copy files & folders</p>
                                </div>
                                <div class="card-icon">
                                    <span style="font-size: 24px;">üìÇ</span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div>
                                    <span id="file-copies-count" class="count-number">0</span>
                                    <span class="count-label">configured</span>
                                </div>
                                <span class="card-link">Configure ‚Üí</span>
                            </div>
                        </div>
                        
                        <div class="dashboard-card" data-tab-click="registry">
                            <div class="card-header">
                                <div>
                                    <h3 class="card-title">Registry Entries</h3>
                                    <p class="card-subtitle">Windows registry keys</p>
                                </div>
                                <div class="card-icon">
                                    <span style="font-size: 24px;">üîß</span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div>
                                    <span id="registry-entries-count" class="count-number">0</span>
                                    <span class="count-label">configured</span>
                                </div>
                                <span class="card-link">Configure ‚Üí</span>
                            </div>
                        </div>
                        
                        <div class="dashboard-card" data-tab-click="fonts">
                            <div class="card-header">
                                <div>
                                    <h3 class="card-title">Fonts</h3>
                                    <p class="card-subtitle">Install custom fonts</p>
                                </div>
                                <div class="card-icon">
                                    <span style="font-size: 24px;">üî§</span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div>
                                    <span id="fonts-count" class="count-number">0</span>
                                    <span class="count-label">configured</span>
                                </div>
                                <span class="card-link">Configure ‚Üí</span>
                            </div>
                        </div>
                        
                        <div class="dashboard-card" data-tab-click="startup-scripts">
                            <div class="card-header">
                                <div>
                                    <h3 class="card-title">Startup Scripts</h3>
                                    <p class="card-subtitle">Application startup automation</p>
                                </div>
                                <div class="card-icon">
                                    <span style="font-size: 24px;">üöÄ</span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div>
                                    <span id="startup-scripts-count" class="count-number">0</span>
                                    <span class="count-label">configured</span>
                                </div>
                                <span class="card-link">Configure ‚Üí</span>
                            </div>
                        </div>
                        
                        <div class="dashboard-card" data-tab-click="certificates">
                            <div class="card-header">
                                <div>
                                    <h3 class="card-title">Certificates</h3>
                                    <p class="card-subtitle">SSL & security certificates</p>
                                </div>
                                <div class="card-icon">
                                    <span style="font-size: 24px;">üîí</span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <div>
                                    <span id="certificates-count" class="count-number">0</span>
                                    <span class="count-label">configured</span>
                                </div>
                                <span class="card-link">Configure ‚Üí</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Network Drives Tab -->
                <div class="tab-content" id="network-drives">
                    <h2>Map Network Drives</h2>
                    <p>Configure network drives to be mapped during script execution.</p>

                    <div class="card">
                        <h3>Add Network Drive</h3>
                        <div class="form-group">
                            <label for="drive-letter">Drive Letter:</label>
                            <select id="drive-letter">
                                <option value="Z:">Z:</option>
                                <option value="Y:">Y:</option>
                                <option value="X:">X:</option>
                                <option value="W:">W:</option>
                                <option value="V:">V:</option>
                                <option value="U:">U:</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="network-path">Network Path:</label>
                            <input type="text" id="network-path" placeholder="\\server\share">
                        </div>
                        <button type="button" id="add-network-drive">Add Network Drive</button>
                    </div>

                    <div class="card">
                        <h3>Configured Network Drives</h3>
                        <div id="network-drives-list" class="item-list">
                            <p style="color: #666; font-style: italic;">No network drives configured yet.</p>
                        </div>
                    </div>
                </div>

                <!-- Applications Tab -->
                <div class="tab-content" id="applications">
                    <h2>Install Applications</h2>
                    <p>Configure applications to be installed during script execution.</p>

                    <div class="card">
                        <h3>Add Application</h3>
                        <div class="form-group">
                            <label for="app-name">Application Name:</label>
                            <input type="text" id="app-name" placeholder="Microsoft Office 365">
                        </div>
                        <div class="form-group">
                            <label for="installer-path">Installer Path:</label>
                            <div class="input-group">
                                <input type="text" id="installer-path" placeholder="C:\Temp\Setup.exe">
                                <button type="button" class="btn-secondary">Browse</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="install-args">Installation Arguments:</label>
                            <input type="text" id="install-args" placeholder="/quiet /norestart">
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="wait-for-completion">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Wait for Completion</span>
                            </div>
                        </div>
                        <button type="button" id="add-application">Add Application</button>
                    </div>

                    <div class="card">
                        <h3>Configured Applications</h3>
                        <div id="applications-list" class="item-list">
                            <p style="color: #666; font-style: italic;">No applications configured yet.</p>
                        </div>
                    </div>
                </div>

                <!-- File Copy Tab -->
                <div class="tab-content" id="file-copy">
                    <h2>Copy Files</h2>
                    <p>Configure files and directories to be copied during script execution.</p>

                    <div class="card">
                        <h3>Add File Copy Operation</h3>
                        <div class="form-group">
                            <label for="source-path">Source Path:</label>
                            <div class="input-group">
                                <input type="text" id="source-path" placeholder="\\server\share\file.txt">
                                <button type="button" class="btn-secondary">Browse</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="destination-path">Destination Path:</label>
                            <div class="input-group">
                                <input type="text" id="destination-path" placeholder="C:\Temp\">
                                <button type="button" class="btn-secondary">Browse</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="copy-folder">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Copy Folder (Recursive)</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="overwrite-existing">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Overwrite Existing Files</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="validate-copy" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Validate Copy with File Hash</span>
                            </div>
                        </div>
                        <button type="button" id="add-file-copy">Add File Copy</button>
                    </div>

                    <div class="card">
                        <h3>Configured File Operations</h3>
                        <div id="file-copy-list" class="item-list">
                            <p style="color: #666; font-style: italic;">No file operations configured yet.</p>
                        </div>
                    </div>
                </div>

                <!-- Registry Entries Tab -->
                <div class="tab-content" id="registry">
                    <h2>Registry Entries</h2>
                    <p>Configure registry entries to be added during script execution.</p>

                    <div class="card">
                        <h3>Import Registry File</h3>
                        <div class="form-group">
                            <label for="reg-file-path">Registry File Path (.reg):</label>
                            <div class="input-group">
                                <input type="text" id="reg-file-path" placeholder="C:\Temp\settings.reg">
                                <button type="button" class="btn-secondary">Browse</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="reg-file-silent" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Silent Import (No User Prompts)</span>
                            </div>
                        </div>
                        <button type="button" id="add-reg-file">Add Registry File</button>
                    </div>

                    <div class="card">
                        <h3>Add Individual Registry Entry</h3>
                        <div class="form-group">
                            <label for="reg-hive">Registry Hive:</label>
                            <select id="reg-hive">
                                <option value="HKLM:">HKEY_LOCAL_MACHINE</option>
                                <option value="HKCU:">HKEY_CURRENT_USER</option>
                                <option value="HKCR:">HKEY_CLASSES_ROOT</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="reg-path">Registry Path:</label>
                            <input type="text" id="reg-path" placeholder="SOFTWARE\Microsoft\Windows">
                        </div>
                        <div class="form-group">
                            <label for="reg-name">Value Name:</label>
                            <input type="text" id="reg-name" placeholder="MyValue">
                        </div>
                        <div class="form-group">
                            <label for="reg-type">Value Type:</label>
                            <select id="reg-type">
                                <option value="String">String (REG_SZ)</option>
                                <option value="DWord">DWORD (REG_DWORD)</option>
                                <option value="Binary">Binary (REG_BINARY)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="reg-value">Value Data:</label>
                            <input type="text" id="reg-value" placeholder="Value data">
                        </div>
                        <button type="button" id="add-registry">Add Registry Entry</button>
                    </div>

                    <div class="card">
                        <h3>Configured Registry Operations</h3>
                        <div id="registry-list" class="item-list">
                            <p style="color: #666; font-style: italic;">No registry operations configured yet.</p>
                        </div>
                    </div>
                </div>

                <!-- Fonts Tab -->
                <div class="tab-content" id="fonts">
                    <h2>Install Fonts</h2>
                    <p>Configure fonts to be installed during script execution.</p>

                    <div class="card">
                        <h3>Add Single Font</h3>
                        <div class="form-group">
                            <label for="font-path">Font File Path:</label>
                            <div class="input-group">
                                <input type="text" id="font-path" placeholder="C:\Temp\FontName.ttf">
                                <button type="button" class="btn-secondary">Browse</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="font-name">Font Name (Optional):</label>
                            <input type="text" id="font-name" placeholder="Arial Nova">
                        </div>
                        <button type="button" id="add-font">Add Single Font</button>
                    </div>

                    <div class="card">
                        <h3>Add Fonts from Directory</h3>
                        <div class="form-group">
                            <label for="font-directory">Font Directory Path:</label>
                            <div class="input-group">
                                <input type="text" id="font-directory" placeholder="C:\Temp\Fonts\">
                                <button type="button" class="btn-secondary">Browse</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="font-extensions">Font File Extensions:</label>
                            <input type="text" id="font-extensions" value="*.ttf,*.otf,*.woff,*.woff2" placeholder="*.ttf,*.otf,*.woff,*.woff2">
                            <small style="color: #666; font-size: 12px;">Comma-separated list of file extensions to include</small>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="font-recursive" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Include Subdirectories (Recursive)</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="font-skip-existing" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Skip Already Installed Fonts</span>
                            </div>
                        </div>
                        <button type="button" id="add-font-directory">Add Font Directory</button>
                    </div>

                    <div class="card">
                        <h3>Configured Fonts</h3>
                        <div id="fonts-list" class="item-list">
                            <p style="color: #666; font-style: italic;">No fonts configured yet.</p>
                        </div>
                    </div>
                </div>

                <!-- Certificates Tab -->
                <div class="tab-content" id="certificates">
                    <h2>Install SSL Certificates</h2>
                    <p>Configure SSL certificates to be installed during script execution.</p>

                    <div class="card">
                        <h3>Add Certificate</h3>
                        <div class="form-group">
                            <label for="cert-path">Certificate File Path:</label>
                            <div class="input-group">
                                <input type="text" id="cert-path" placeholder="C:\Temp\certificate.cer">
                                <button type="button" class="btn-secondary">Browse</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="cert-store">Certificate Store:</label>
                            <select id="cert-store">
                                <option value="Root">Trusted Root Certification Authorities</option>
                                <option value="CA">Intermediate Certification Authorities</option>
                                <option value="My">Personal</option>
                                <option value="TrustedPublisher">Trusted Publishers</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="cert-location">Store Location:</label>
                            <select id="cert-location">
                                <option value="LocalMachine">Local Machine</option>
                                <option value="CurrentUser">Current User</option>
                            </select>
                        </div>
                        <button type="button" id="add-certificate">Add Certificate</button>
                    </div>

                    <div class="card">
                        <h3>Configured Certificates</h3>
                        <div id="certificates-list" class="item-list">
                            <p style="color: #666; font-style: italic;">No certificates configured yet.</p>
                        </div>
                    </div>
                </div>

                <!-- Startup Scripts Tab -->
                <div class="tab-content" id="startup-scripts">
                    <h2>Application Startup Scripts</h2>
                    <p>Create standalone PowerShell scripts for application startup automation.</p>

                    <div class="card">
                        <h3>Add Startup Application</h3>
                        <div class="form-group">
                            <label for="startup-app-name">Application Name:</label>
                            <input type="text" id="startup-app-name" placeholder="Microsoft Excel">
                        </div>
                        <div class="form-group">
                            <label for="startup-app-path">Application Path:</label>
                            <div class="input-group">
                                <input type="text" id="startup-app-path" placeholder="C:\Program Files\Microsoft Office\root\Office16\EXCEL.EXE">
                                <button type="button" class="btn-secondary">Browse</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="startup-app-args">Arguments (Optional):</label>
                            <input type="text" id="startup-app-args" placeholder="/safe">
                        </div>
                        <div class="form-group">
                            <label for="startup-delay">Startup Delay (seconds):</label>
                            <input type="number" id="startup-delay" min="0" max="300" value="0" placeholder="0">
                            <small style="color: #666; font-size: 12px;">Delay before launching this application</small>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="startup-wait-exit">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Wait for Previous App to Close</span>
                            </div>
                        </div>
                        <button type="button" id="add-startup-app">Add Startup Application</button>
                    </div>

                    <div class="card">
                        <h3>Configured Startup Applications</h3>
                        <div id="startup-apps-list" class="item-list">
                            <p style="color: #666; font-style: italic;">No startup applications configured yet.</p>
                        </div>
                    </div>

                    <div class="card">
                        <h3>Generated Startup Script</h3>
                        <div id="generated-startup-script" class="generated-code">No startup script generated yet. Configure applications and click "Generate Startup Script".</div>
                        <button type="button" id="generate-startup-script">Generate Startup Script</button>
                        <button type="button" id="copy-startup-script" class="btn-secondary" style="margin-left: 10px;">Copy to Clipboard</button>
                    </div>
                </div>

                <!-- Generate Script Tab -->
                <div class="tab-content" id="generate">
                    <h2>Generate PowerShell Script</h2>
                    <p>Review your configuration and generate the final PowerShell deployment script.</p>

                    <div class="card">
                        <h3>Script Options</h3>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="add-logging" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Add Logging</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="add-error-handling" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Add Error Handling</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="require-admin">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Require Administrator Rights</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="auto-reboot">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Auto Reboot After Completion</span>
                            </div>
                        </div>
                        <div class="form-group" id="reboot-delay-group" style="display: none;">
                            <label for="reboot-delay">Reboot Delay (seconds):</label>
                            <input type="number" id="reboot-delay" min="0" max="3600" value="10" placeholder="10">
                            <small style="color: #666; font-size: 12px;">Enter 0 for immediate reboot, max 3600 seconds (1 hour)</small>
                        </div>
                        <button type="button" id="generate-script">Generate PowerShell Script</button>
                        <button type="button" id="copy-script" class="btn-secondary" style="margin-left: 10px;">Copy to Clipboard</button>
                    </div>

                    <div class="card">
                        <h3>Generated Script</h3>
                        <div id="generated-script" class="generated-code">No script generated yet. Configure components and click "Generate PowerShell Script".</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        "use strict";
        
        var PowerShellGenerator = (function() {
            var data = {
                networkDrives: [],
                applications: [],
                fileCopies: [],
                registryEntries: [],
                fonts: [],
                certificates: [],
                startupApps: []
            };

            function switchToTab(tabId) {
                var navItems = document.querySelectorAll('.nav-item');
                var tabContents = document.querySelectorAll('.tab-content');
                
                for (var i = 0; i < navItems.length; i++) {
                    navItems[i].classList.remove('active');
                }
                
                for (var i = 0; i < tabContents.length; i++) {
                    tabContents[i].classList.remove('active');
                }
                
                var navItem = document.querySelector('[data-tab="' + tabId + '"]');
                var tabContent = document.getElementById(tabId);
                
                if (navItem && tabContent) {
                    navItem.classList.add('active');
                    tabContent.classList.add('active');
                }
            }

            function updateDashboardCounts() {
                var elements = [
                    { id: 'network-drives-count', count: data.networkDrives.length },
                    { id: 'applications-count', count: data.applications.length },
                    { id: 'file-copies-count', count: data.fileCopies.length },
                    { id: 'registry-entries-count', count: data.registryEntries.length },
                    { id: 'fonts-count', count: data.fonts.length },
                    { id: 'certificates-count', count: data.certificates.length },
                    { id: 'startup-scripts-count', count: data.startupApps.length }
                ];

                for (var i = 0; i < elements.length; i++) {
                    var element = elements[i];
                    var countElement = document.getElementById(element.id);
                    if (countElement) {
                        countElement.textContent = element.count;
                    }
                }
            }

            function addNetworkDrive() {
                var driveLetter = document.getElementById('drive-letter').value;
                var networkPath = document.getElementById('network-path').value.trim();

                if (!networkPath) {
                    alert('Please enter a network path');
                    return;
                }

                var networkDrive = {
                    id: Date.now(),
                    driveLetter: driveLetter,
                    networkPath: networkPath
                };

                data.networkDrives.push(networkDrive);
                updateNetworkDrivesList();
                updateDashboardCounts();
                
                document.getElementById('network-path').value = '';
            }

            function updateNetworkDrivesList() {
                var list = document.getElementById('network-drives-list');
                if (!list) return;

                list.innerHTML = '';

                if (data.networkDrives.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No network drives configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.networkDrives.length; i++) {
                    var drive = data.networkDrives[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-drive="' + drive.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + drive.driveLetter + '</strong> ‚Üí ' + drive.networkPath;
                    list.appendChild(item);
                }
            }

            function removeNetworkDrive(id) {
                data.networkDrives = data.networkDrives.filter(function(drive) {
                    return drive.id !== id;
                });
                updateNetworkDrivesList();
                updateDashboardCounts();
            }

            function addApplication() {
                var appName = document.getElementById('app-name').value.trim();
                var installerPath = document.getElementById('installer-path').value.trim();
                var installArgs = document.getElementById('install-args').value.trim();
                var waitForCompletion = document.getElementById('wait-for-completion').checked;

                if (!appName || !installerPath) {
                    alert('Please enter application name and installer path');
                    return;
                }

                var application = {
                    id: Date.now(),
                    appName: appName,
                    installerPath: installerPath,
                    installArgs: installArgs,
                    waitForCompletion: waitForCompletion
                };

                data.applications.push(application);
                updateApplicationsList();
                updateDashboardCounts();
                
                document.getElementById('app-name').value = '';
                document.getElementById('installer-path').value = '';
                document.getElementById('install-args').value = '';
                document.getElementById('wait-for-completion').checked = false;
            }

            function updateApplicationsList() {
                var list = document.getElementById('applications-list');
                if (!list) return;

                list.innerHTML = '';

                if (data.applications.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No applications configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.applications.length; i++) {
                    var app = data.applications[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-app="' + app.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + app.appName + '</strong><br>' +
                        'Path: ' + app.installerPath + '<br>' +
                        'Args: ' + (app.installArgs || 'None') + '<br>' +
                        '<small>Wait for completion: ' + (app.waitForCompletion ? 'Yes' : 'No') + '</small>';
                    list.appendChild(item);
                }
            }

            function removeApplication(id) {
                data.applications = data.applications.filter(function(app) {
                    return app.id !== id;
                });
                updateApplicationsList();
                updateDashboardCounts();
            }

            function addFileCopy() {
                var sourcePath = document.getElementById('source-path').value.trim();
                var destinationPath = document.getElementById('destination-path').value.trim();
                var copyFolder = document.getElementById('copy-folder').checked;
                var overwriteExisting = document.getElementById('overwrite-existing').checked;
                var validateCopy = document.getElementById('validate-copy').checked;

                if (!sourcePath || !destinationPath) {
                    alert('Please enter source and destination paths');
                    return;
                }

                var fileCopy = {
                    id: Date.now(),
                    sourcePath: sourcePath,
                    destinationPath: destinationPath,
                    copyFolder: copyFolder,
                    overwriteExisting: overwriteExisting,
                    validateCopy: validateCopy
                };

                data.fileCopies.push(fileCopy);
                updateFileCopiesList();
                updateDashboardCounts();
                
                document.getElementById('source-path').value = '';
                document.getElementById('destination-path').value = '';
                document.getElementById('copy-folder').checked = false;
                document.getElementById('overwrite-existing').checked = false;
                document.getElementById('validate-copy').checked = true;
            }

            function updateFileCopiesList() {
                var list = document.getElementById('file-copy-list');
                if (!list) return;

                list.innerHTML = '';

                if (data.fileCopies.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No file operations configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.fileCopies.length; i++) {
                    var file = data.fileCopies[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-file="' + file.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + file.sourcePath + '</strong> ‚Üí ' + file.destinationPath + '<br>' +
                        '<small>Folder copy: ' + (file.copyFolder ? 'Yes' : 'No') + ' | Overwrite: ' + (file.overwriteExisting ? 'Yes' : 'No') + ' | Validate: ' + (file.validateCopy ? 'Yes' : 'No') + '</small>';
                    list.appendChild(item);
                }
            }

            function removeFileCopy(id) {
                data.fileCopies = data.fileCopies.filter(function(file) {
                    return file.id !== id;
                });
                updateFileCopiesList();
                updateDashboardCounts();
            }

            function addRegistryEntry() {
                var regHive = document.getElementById('reg-hive').value;
                var regPath = document.getElementById('reg-path').value.trim();
                var regName = document.getElementById('reg-name').value.trim();
                var regType = document.getElementById('reg-type').value;
                var regValue = document.getElementById('reg-value').value.trim();

                if (!regPath || !regName || !regValue) {
                    alert('Please fill in all registry fields');
                    return;
                }

                var registryEntry = {
                    id: Date.now(),
                    regHive: regHive,
                    regPath: regPath,
                    regName: regName,
                    regType: regType,
                    regValue: regValue
                };

                data.registryEntries.push(registryEntry);
                updateRegistryList();
                updateDashboardCounts();
                
                document.getElementById('reg-path').value = '';
                document.getElementById('reg-name').value = '';
                document.getElementById('reg-value').value = '';
            }

            function updateRegistryList() {
                var list = document.getElementById('registry-list');
                if (!list) return;

                list.innerHTML = '';
                
                if (data.registryEntries.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No registry operations configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.registryEntries.length; i++) {
                    var reg = data.registryEntries[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-registry="' + reg.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>üîß Registry Entry:</strong> ' + reg.regHive + '\\' + reg.regPath + '<br>' +
                        'Name: ' + reg.regName + ' | Type: ' + reg.regType + ' | Value: ' + reg.regValue;
                    list.appendChild(item);
                }
            }

            function removeRegistryEntry(id) {
                data.registryEntries = data.registryEntries.filter(function(reg) {
                    return reg.id !== id;
                });
                updateRegistryList();
                updateDashboardCounts();
            }

            function addFont() {
                var fontPath = document.getElementById('font-path').value.trim();
                var fontName = document.getElementById('font-name').value.trim();

                if (!fontPath) {
                    alert('Please enter a font file path');
                    return;
                }

                var font = {
                    id: Date.now(),
                    fontPath: fontPath,
                    fontName: fontName
                };

                data.fonts.push(font);
                updateFontsList();
                updateDashboardCounts();
                
                document.getElementById('font-path').value = '';
                document.getElementById('font-name').value = '';
            }

            function updateFontsList() {
                var list = document.getElementById('fonts-list');
                if (!list) return;

                list.innerHTML = '';
                
                if (data.fonts.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No fonts configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.fonts.length; i++) {
                    var font = data.fonts[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-font="' + font.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>üìÑ Font:</strong> ' + font.fontPath +
                        (font.fontName ? '<br>Name: ' + font.fontName : '');
                    list.appendChild(item);
                }
            }

            function removeFont(id) {
                data.fonts = data.fonts.filter(function(font) {
                    return font.id !== id;
                });
                updateFontsList();
                updateDashboardCounts();
            }

            function addCertificate() {
                var certPath = document.getElementById('cert-path').value.trim();
                var certStore = document.getElementById('cert-store').value;
                var certLocation = document.getElementById('cert-location').value;

                if (!certPath) {
                    alert('Please enter a certificate file path');
                    return;
                }

                var certificate = {
                    id: Date.now(),
                    certPath: certPath,
                    certStore: certStore,
                    certLocation: certLocation
                };

                data.certificates.push(certificate);
                updateCertificatesList();
                updateDashboardCounts();
                
                document.getElementById('cert-path').value = '';
            }

            function updateCertificatesList() {
                var list = document.getElementById('certificates-list');
                if (!list) return;

                list.innerHTML = '';

                if (data.certificates.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No certificates configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.certificates.length; i++) {
                    var cert = data.certificates[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-cert="' + cert.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + cert.certPath + '</strong><br>' +
                        'Store: ' + cert.certStore + ' (' + cert.certLocation + ')';
                    list.appendChild(item);
                }
            }

            function removeCertificate(id) {
                data.certificates = data.certificates.filter(function(cert) {
                    return cert.id !== id;
                });
                updateCertificatesList();
                updateDashboardCounts();
            }

            function addStartupApp() {
                var appName = document.getElementById('startup-app-name').value.trim();
                var appPath = document.getElementById('startup-app-path').value.trim();
                var appArgs = document.getElementById('startup-app-args').value.trim();
                var delay = parseInt(document.getElementById('startup-delay').value) || 0;
                var waitForExit = document.getElementById('startup-wait-exit').checked;

                if (!appName || !appPath) {
                    alert('Please enter application name and path');
                    return;
                }

                var startupApp = {
                    id: Date.now(),
                    appName: appName,
                    appPath: appPath,
                    appArgs: appArgs,
                    delay: delay,
                    waitForExit: waitForExit
                };

                data.startupApps.push(startupApp);
                updateStartupAppsList();
                updateDashboardCounts();
                
                document.getElementById('startup-app-name').value = '';
                document.getElementById('startup-app-path').value = '';
                document.getElementById('startup-app-args').value = '';
                document.getElementById('startup-delay').value = '0';
                document.getElementById('startup-wait-exit').checked = false;
            }

            function updateStartupAppsList() {
                var list = document.getElementById('startup-apps-list');
                if (!list) return;

                list.innerHTML = '';

                if (data.startupApps.length === 0) {
                    list.innerHTML = '<p style="color: #666; font-style: italic;">No startup applications configured yet.</p>';
                    return;
                }

                for (var i = 0; i < data.startupApps.length; i++) {
                    var app = data.startupApps[i];
                    var item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = 
                        '<div class="item-actions">' +
                            '<button type="button" class="remove-btn" data-remove-startup="' + app.id + '" title="Delete">üóëÔ∏è</button>' +
                        '</div>' +
                        '<strong>' + (i + 1) + '. ' + app.appName + '</strong><br>' +
                        'Path: ' + app.appPath + '<br>' +
                        'Args: ' + (app.appArgs || 'None') + ' | Delay: ' + app.delay + 's<br>' +
                        '<small>Wait for exit: ' + (app.waitForExit ? 'Yes' : 'No') + '</small>';
                    list.appendChild(item);
                }
            }

            function removeStartupApp(id) {
                data.startupApps = data.startupApps.filter(function(app) {
                    return app.id !== id;
                });
                updateStartupAppsList();
                updateDashboardCounts();
            }

            function generateScript() {
                var addLogging = document.getElementById('add-logging').checked;
                var addErrorHandling = document.getElementById('add-error-handling').checked;
                var requireAdmin = document.getElementById('require-admin').checked;
                var autoReboot = document.getElementById('auto-reboot').checked;
                var rebootDelay = parseInt(document.getElementById('reboot-delay').value) || 10;

                var script = '';

                script += '# PowerShell Deployment Script\n';
                script += '# Generated by PowerShell Script Generator\n';
                script += '# Generated on: ' + new Date().toLocaleDateString('en-GB') + '\n\n';

                if (requireAdmin) {
                    script += '# Check for Administrator privileges\n';
                    script += 'if (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {\n';
                    script += '    Write-Host "This script requires Administrator privileges. Please run as Administrator." -ForegroundColor Red\n';
                    script += '    exit 1\n';
                    script += '}\n\n';
                }

                if (addLogging) {
                    script += '# Setup logging\n';
                    script += '$LogPath = "$env:TEMP\\deployment_log_$(Get-Date -Format "dd-MM-yyyy_HHmmss").txt"\n';
                    script += 'function Write-Log {\n';
                    script += '    param([string]$Message, [string]$Level = "INFO")\n';
                    script += '    $TimeStamp = Get-Date -Format "dd-MM-yyyy HH:mm:ss"\n';
                    script += '    $LogEntry = "[$TimeStamp] [$Level] $Message"\n';
                    script += '    Write-Host $LogEntry\n';
                    script += '    Add-Content -Path $LogPath -Value $LogEntry\n';
                    script += '}\n\n';
                    script += 'Write-Log "Starting deployment script execution"\n\n';
                }

                if (addErrorHandling) {
                    script += '# Error handling\n';
                    script += '$ErrorActionPreference = "Stop"\n\n';
                }

                if (data.networkDrives.length > 0) {
                    script += '# === NETWORK DRIVES ===\n';
                    if (addLogging) script += 'Write-Log "Configuring network drives"\n';
                    
                    for (var i = 0; i < data.networkDrives.length; i++) {
                        var drive = data.networkDrives[i];
                        if (addErrorHandling) {
                            script += 'try {\n    ';
                        }
                        script += 'New-PSDrive -Name "' + drive.driveLetter.replace(':', '') + '" -PSProvider FileSystem -Root "' + drive.networkPath + '" -Persist\n';
                        
                        if (addLogging) {
                            script += '    Write-Log "Mapped network drive ' + drive.driveLetter + ' to ' + drive.networkPath + '"\n';
                        }
                        
                        if (addErrorHandling) {
                            script += '} catch {\n';
                            if (addLogging) {
                                script += '    Write-Log "Failed to map drive ' + drive.driveLetter + ': $($_.Exception.Message)" "ERROR"\n';
                            }
                            script += '}\n';
                        }
                        script += '\n';
                    }
                }

                if (data.applications.length > 0) {
                    script += '# === APPLICATIONS ===\n';
                    if (addLogging) script += 'Write-Log "Installing applications"\n';
                    
                    for (var i = 0; i < data.applications.length; i++) {
                        var app = data.applications[i];
                        if (addErrorHandling) {
                            script += 'try {\n    ';
                        }
                        
                        script += 'Start-Process -FilePath "' + app.installerPath + '"';
                        if (app.installArgs) {
                            script += ' -ArgumentList "' + app.installArgs + '"';
                        }
                        if (